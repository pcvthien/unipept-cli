<%=
  @result.map do |k, v|
    v.map do |p, u|
      lineage_info = Hash[Lineage::ORDER.zip(p.lineage.to_a)]
      lineage_info.reject! { |k,v| v.blank? } unless @full_lineage
      { sequence: k,
        id: p.id,
        taxon_name: p.name,
        parent_taxon_id: p.parent_id,
        taxon_rank: p.rank,
        uniprot_id: u,
      }.merge(lineage_info)
    end
  end.flatten.to_json.html_safe
%>
